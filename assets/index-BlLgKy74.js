import{_ as z,r as d,c as y,o as c,b as e,a,w as o,u as D,y as de,d as C,h as ce,E as P,z as ue,g as R,p as O,t as x,B as ie,C as Y,F as K,k as Q,e as F,D as me,G as fe,H as pe,I as ve,J as ge,K as _e,L as we,n as X,s as be,f as ne,M as re,m as le,x as he,q as ke}from"./index-BDvhqHdq.js";const ye={class:"header-title"},Ce={__name:"UserHeaderTitle",setup(l){return(b,u)=>{const i=d("el-icon");return c(),y("div",ye,[e(i,null,{default:o(()=>[e(D(de))]),_:1}),u[0]||(u[0]=a("h2",null,"个人设置",-1))])}}},Ie=z(Ce,[["__scopeId","data-v-5aa5c3e3"]]),$e={class:"header-actions"},Ve={__name:"UserHeaderActions",emits:["view-profile","share-profile"],setup(l,{emit:b}){const u=b,i=r=>{switch(r){case"viewProfile":u("view-profile");break;case"shareProfile":u("share-profile");break;case"report":P.warning("举报功能暂未开放");break}};return(r,n)=>{const w=d("el-icon"),I=d("el-button"),v=d("el-dropdown-item"),t=d("el-dropdown-menu"),h=d("el-dropdown");return c(),y("div",$e,[e(h,{onCommand:i,trigger:"click"},{dropdown:o(()=>[e(t,null,{default:o(()=>[e(v,{command:"viewProfile"},{default:o(()=>[...n[1]||(n[1]=[C("预览个人主页",-1)])]),_:1}),e(v,{command:"shareProfile"},{default:o(()=>[...n[2]||(n[2]=[C("分享个人主页",-1)])]),_:1}),e(v,{command:"report",divided:""},{default:o(()=>[...n[3]||(n[3]=[C("举报用户",-1)])]),_:1})]),_:1})]),default:o(()=>[e(I,null,{default:o(()=>[n[0]||(n[0]=C(" 更多操作 ",-1)),e(w,{class:"el-icon--right"},{default:o(()=>[e(D(ce))]),_:1})]),_:1})]),_:1})])}}},Se=z(Ve,[["__scopeId","data-v-99d846a8"]]),Pe={class:"profile-bg"},xe={__name:"ProfileHeader",props:{backgroundImage:{type:String,default:""},isFollowing:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!0}},emits:["follow","message","share","report"],setup(l,{emit:b}){const i=l.backgroundImage||"https://via.placeholder.com/1200x300?text=个人主页背景";return(r,n)=>(c(),y("div",Pe,[a("div",{class:"bg-image",style:ue({backgroundImage:`url(${D(i)})`})},null,4)]))}},Ee=z(xe,[["__scopeId","data-v-cb97b9a6"]]),Fe={class:"profile-info"},Me={class:"profile-content"},Te={class:"avatar-wrapper"},Ue={class:"user-details"},Be={class:"username-row"},De={class:"username"},Ae={class:"stats-section"},Re={class:"stat-value"},Le={class:"stat-value"},He={class:"stat-value"},qe={class:"top-actions"},Oe={key:1,class:"user-signature"},ze={class:"user-tags"},Ne="/avatar-placeholder.png",je={__name:"ProfileInfo",props:{userInfo:{type:Object,required:!0},stats:{type:Object,default:()=>({following:0,followers:0,likes:0,views:0})},userTags:{type:Array,default:()=>[]},canEdit:{type:Boolean,default:!0},backgroundImage:{type:String,default:""}},emits:["avatarChange","nameEdit","bioEdit","addTag","followingClick","followersClick","likesClick","bgChange"],setup(l,{emit:b}){const u=b,i=s=>s?s.charAt(0).toUpperCase():"U",r=()=>{u("avatarChange")},n=()=>{u("nameEdit")},w=()=>{u("bioEdit")},I=()=>{u("addTag")},v=()=>{u("followingClick")},t=()=>{u("followersClick")},h=()=>{u("likesClick")},E=()=>{u("follow")},g=()=>{u("message")},k=s=>{s==="share"?u("share"):s==="report"&&u("report")};return(s,m)=>{const p=d("el-avatar"),f=d("el-icon"),_=d("el-button"),U=d("ChatDotSquare"),B=d("MoreFilled"),L=d("el-dropdown-item"),H=d("el-dropdown-menu"),N=d("el-dropdown"),$=d("el-tag");return c(),y("div",Fe,[a("div",Me,[a("div",Te,[e(p,{size:"120",src:l.userInfo.avatar||Ne,class:"profile-avatar"},{default:o(()=>[C(x(i(l.userInfo.username)),1)]),_:1},8,["src"]),l.canEdit?(c(),R(_,{key:0,size:"small",class:"edit-avatar-btn",onClick:r},{default:o(()=>[e(f,null,{default:o(()=>[e(D(ie))]),_:1})]),_:1})):O("",!0)]),a("div",Ue,[a("div",Be,[a("h1",De,x(l.userInfo.username),1),l.canEdit?(c(),R(_,{key:0,size:"small",class:"edit-name-btn",onClick:n},{default:o(()=>[e(f,null,{default:o(()=>[e(D(ie))]),_:1})]),_:1})):O("",!0)]),a("div",Ae,[a("div",{class:"stat-item",onClick:v},[a("span",Re,x(l.stats.following),1),m[0]||(m[0]=a("span",{class:"stat-label"},"关注",-1))]),m[3]||(m[3]=a("div",{class:"stat-divider"},null,-1)),a("div",{class:"stat-item",onClick:t},[a("span",Le,x(l.stats.followers),1),m[1]||(m[1]=a("span",{class:"stat-label"},"粉丝",-1))]),m[4]||(m[4]=a("div",{class:"stat-divider"},null,-1)),a("div",{class:"stat-item",onClick:h},[a("span",He,x(l.stats.likes),1),m[2]||(m[2]=a("span",{class:"stat-label"},"获赞与收藏",-1))]),m[5]||(m[5]=a("div",{class:"stat-divider"},null,-1))]),a("div",qe,[e(_,{type:"primary",size:"small",class:"follow-btn",onClick:E},{default:o(()=>[e(f,null,{default:o(()=>[e(D(Y))]),_:1}),C(" "+x(s.isFollowing?"已关注":"关注"),1)]),_:1}),e(_,{size:"small",class:"message-btn",onClick:g},{default:o(()=>[e(f,null,{default:o(()=>[e(U)]),_:1}),m[6]||(m[6]=C(" 私信 ",-1))]),_:1}),e(N,{trigger:"click",onCommand:k},{dropdown:o(()=>[e(H,null,{default:o(()=>[e(L,{command:"share"},{default:o(()=>[...m[7]||(m[7]=[C("分享",-1)])]),_:1}),e(L,{command:"report"},{default:o(()=>[...m[8]||(m[8]=[C("举报",-1)])]),_:1})]),_:1})]),default:o(()=>[e(_,{size:"small"},{default:o(()=>[e(f,null,{default:o(()=>[e(B)]),_:1})]),_:1})]),_:1})]),l.canEdit?(c(),y("div",{key:0,class:"user-signature",onClick:w},x(l.userInfo.bio||"点击添加个人签名"),1)):(c(),y("div",Oe,x(l.userInfo.bio||"该用户还没有填写个人签名"),1)),a("div",ze,[(c(!0),y(K,null,Q(l.userTags,S=>(c(),R($,{key:S,class:"user-tag"},{default:o(()=>[C(x(S),1)]),_:2},1024))),128)),l.canEdit&&l.userTags.length<8?(c(),R(_,{key:0,size:"small",type:"dashed",class:"add-tag-btn",onClick:I},{default:o(()=>[e(f,null,{default:o(()=>[e(D(Y))]),_:1}),m[9]||(m[9]=C(" 添加标签 ",-1))]),_:1})):O("",!0)])])])])}}},We=z(je,[["__scopeId","data-v-dd71d0d7"]]),Je={class:"profile-content"},Ge={class:"profile-nav"},Ke={class:"nav-item"},Qe={key:0,class:"count-badge"},Ye={class:"tab-content"},Xe={key:0,class:"works-grid"},Ze=["onClick"],eo={class:"work-thumbnail"},oo=["src","alt"],to={class:"video-duration"},ao={class:"work-info"},so=["title"],lo={class:"work-stats"},no={class:"publish-time"},io={key:1,class:"empty-state"},ro={class:"nav-item"},co={key:0,class:"count-badge"},uo={class:"tab-content"},mo={key:0,class:"comments-list"},fo={class:"comment-content"},po={class:"comment-header"},vo={class:"comment-user"},go={class:"comment-time"},_o={class:"comment-text"},wo={class:"comment-actions"},bo=["onClick"],ho=["onClick"],ko={key:1,class:"empty-state"},yo={class:"nav-item"},Co={class:"tab-content"},Io={key:0,class:"recommendations-grid"},$o=["onClick"],Vo={class:"rec-thumbnail"},So=["src","alt"],Po={class:"rec-info"},xo={class:"rec-title"},Eo={class:"rec-stats"},Fo={key:1,class:"empty-state"},Mo={__name:"ProfileContent",props:{contentStats:{type:Object,default:()=>({works:0,comments:0,recommendations:0})},worksList:{type:Array,default:()=>[]},commentsList:{type:Array,default:()=>[]},recommendationsList:{type:Array,default:()=>[]},canEdit:{type:Boolean,default:!0}},emits:["tabChange","workClick","createWork","commentLike","commentReply","recommendationClick"],setup(l,{expose:b,emit:u}){const i=u,r=F("works"),n=p=>{r.value=p.paneName,i("tabChange",p.paneName)},w=p=>{const f=Math.floor(p/60),_=p%60;return`${f.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`},I=p=>p>=1e4?(p/1e4).toFixed(1)+"万":p.toString(),v=p=>{const f=new Date(p),_=f.getFullYear(),U=(f.getMonth()+1).toString().padStart(2,"0"),B=f.getDate().toString().padStart(2,"0");return`${_}-${U}-${B}`},t=p=>{const f=new Date,_=new Date(p),U=f-_,B=Math.floor(U/1e3),L=Math.floor(B/60),H=Math.floor(L/60),N=Math.floor(H/24);return B<60?"刚刚":L<60?`${L}分钟前`:H<24?`${H}小时前`:N<30?`${N}天前`:v(p)},h=p=>p?p.charAt(0).toUpperCase():"U",E=p=>{i("workClick",p)},g=()=>{i("createWork")},k=p=>{i("commentLike",p)},s=p=>{i("commentReply",p)},m=p=>{i("recommendationClick",p)};return b({activeTab:r,setActiveTab:p=>{r.value=p}}),(p,f)=>{const _=d("el-icon"),U=d("el-button"),B=d("el-tab-pane"),L=d("el-avatar"),H=d("ChatDotSquare"),N=d("el-tabs");return c(),y("div",Je,[a("div",Ge,[e(N,{modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=$=>r.value=$),class:"nav-tabs",onTabClick:n},{default:o(()=>[e(B,{label:"作品",name:"works"},{label:o(()=>[a("span",Ke,[e(_,null,{default:o(()=>[e(D(fe))]),_:1}),f[1]||(f[1]=C(" 作品 ",-1)),l.contentStats.works>0?(c(),y("span",Qe,x(l.contentStats.works),1)):O("",!0)])]),default:o(()=>[a("div",Ye,[l.contentStats.works>0?(c(),y("div",Xe,[(c(!0),y(K,null,Q(l.worksList,($,S)=>(c(),y("div",{key:S,class:"work-item",onClick:W=>E($)},[a("div",eo,[a("img",{src:$.cover||`https://via.placeholder.com/280x160?text=作品${S+1}`,alt:$.title,class:"work-image"},null,8,oo),a("div",to,x(w($.duration||323)),1)]),a("div",ao,[a("div",{class:"work-title",title:$.title||`示例作品 ${S+1}`},x($.title||`示例作品 ${S+1}`),9,so),a("div",lo,[a("span",null,x(I($.views||Math.floor(Math.random()*1e4)))+"播放",1),a("span",null,x(I($.danmaku||Math.floor(Math.random()*1e3)))+"弹幕",1)]),a("div",no,x(v($.publishDate||new Date(2023,5,10+S))),1)])],8,Ze))),128))])):(c(),y("div",io,[e(_,{class:"empty-icon"},{default:o(()=>[e(D(me))]),_:1}),f[3]||(f[3]=a("p",null,"暂无作品内容",-1)),l.canEdit?(c(),R(U,{key:0,type:"primary",onClick:g},{default:o(()=>[e(_,null,{default:o(()=>[e(D(Y))]),_:1}),f[2]||(f[2]=C(" 上传作品 ",-1))]),_:1})):O("",!0)]))])]),_:1}),e(B,{label:"评论",name:"comments"},{label:o(()=>[a("span",ro,[e(_,null,{default:o(()=>[e(D(ge))]),_:1}),f[4]||(f[4]=C(" 评论 ",-1)),l.contentStats.comments>0?(c(),y("span",co,x(l.contentStats.comments),1)):O("",!0)])]),default:o(()=>[a("div",uo,[l.contentStats.comments>0?(c(),y("div",mo,[(c(!0),y(K,null,Q(l.commentsList,($,S)=>(c(),y("div",{key:S,class:"comment-item"},[e(L,{src:$.userAvatar,size:"40"},{default:o(()=>[C(x(h($.userName)),1)]),_:2},1032,["src"]),a("div",fo,[a("div",po,[a("span",vo,x($.userName),1),a("span",go,x(t($.commentTime)),1)]),a("div",_o,x($.content),1),a("div",wo,[a("span",{class:"comment-action",onClick:W=>k($)},[e(_,null,{default:o(()=>[e(D(pe))]),_:1}),C(" "+x(I($.likes||0)),1)],8,bo),a("span",{class:"comment-action",onClick:W=>s($)},[e(_,null,{default:o(()=>[e(D(ve))]),_:1}),f[5]||(f[5]=C(" 回复 ",-1))],8,ho)])])]))),128))])):(c(),y("div",ko,[e(_,{class:"empty-icon"},{default:o(()=>[e(H)]),_:1}),f[6]||(f[6]=a("p",null,"暂无评论内容",-1))]))])]),_:1}),e(B,{label:"推荐",name:"recommendations"},{label:o(()=>[a("span",yo,[e(_,null,{default:o(()=>[e(D(we))]),_:1}),f[7]||(f[7]=C(" 推荐 ",-1))])]),default:o(()=>[a("div",Co,[l.contentStats.recommendations>0?(c(),y("div",Io,[(c(!0),y(K,null,Q(l.recommendationsList,($,S)=>(c(),y("div",{key:S,class:"rec-item",onClick:W=>m($)},[a("div",Vo,[a("img",{src:$.cover||`https://via.placeholder.com/300x170?text=推荐${S+1}`,alt:$.title},null,8,So)]),a("div",Po,[a("div",xo,x($.title||`推荐内容 ${S+1}`),1),a("div",Eo,[a("span",null,x(I($.views||Math.floor(Math.random()*2e4)))+"次播放",1)])])],8,$o))),128))])):(c(),y("div",Fo,[e(_,{class:"empty-icon"},{default:o(()=>[e(D(_e))]),_:1}),f[8]||(f[8]=a("p",null,"暂无推荐内容",-1))]))])]),_:1})]),_:1},8,["modelValue"])])])}}},To=z(Mo,[["__scopeId","data-v-2c154be9"]]),Uo={class:"profile-preview"},Bo={__name:"ProfilePreviewDialog",props:{userInfo:{type:Object,required:!0}},emits:["update:visible","close"],setup(l,{expose:b,emit:u}){const i=l,r=u,n=F(null),w=F(!1),I=["https://via.placeholder.com/1200x300?text=个人主页背景1","https://via.placeholder.com/1200x300?text=个人主页背景2","https://via.placeholder.com/1200x300?text=个人主页背景3","https://via.placeholder.com/1200x300?text=个人主页背景4","https://via.placeholder.com/1200x300?text=个人主页背景5"];let v=0;const t=F({userInfo:i.userInfo,backgroundImage:i.userInfo.backgroundImage||I[0],isFollowing:!1,stats:{following:i.userInfo.following||0,followers:i.userInfo.followers||0,likes:i.userInfo.likes||0,views:i.userInfo.views||0},contentStats:{works:i.userInfo.workCount||0,comments:i.userInfo.commentCount||0,recommendations:i.userInfo.recommendationCount||0},tags:i.userInfo.tags||[],works:[],comments:[],recommendations:[]});X(()=>i.userInfo,V=>{t.value.userInfo=V,t.value.stats={following:V.following||0,followers:V.followers||0,likes:V.likes||0,views:V.views||0},t.value.contentStats={works:V.workCount||0,comments:V.commentCount||0,recommendations:V.recommendationCount||0},t.value.tags=V.tags||[],V.backgroundImage&&(t.value.backgroundImage=V.backgroundImage),h()},{deep:!0});const h=()=>{const V=t.value.userInfo;t.value.works=M(t.value.contentStats.works||6,V.username||"用户"),t.value.comments=T(t.value.contentStats.comments||5),t.value.recommendations=G(t.value.contentStats.recommendations||4)},E=V=>{w.value=V},g=()=>{w.value=!0,setTimeout(()=>{n.value&&n.value.setActiveTab("works")},100),h()},k=()=>{w.value=!1},s=()=>{w.value=!1,r("close"),r("update:visible",!1)},m=()=>{t.value.isFollowing=!t.value.isFollowing,t.value.isFollowing?t.value.stats.followers++:t.value.stats.followers=Math.max(0,t.value.stats.followers-1),console.log("关注/取消关注用户:",t.value.userInfo.username)},p=()=>{console.log("发送私信给用户:",t.value.userInfo.username)},f=()=>{console.log("分享个人主页:",t.value.userInfo.username)},_=()=>{console.log("举报用户:",t.value.userInfo.username)},U=()=>{console.log("更改背景图"),v=(v+1)%I.length,t.value.backgroundImage=I[v]},B=()=>{console.log("更改头像:",t.value.userInfo.username)},L=()=>{console.log("编辑用户名:",t.value.userInfo.username)},H=()=>{console.log("编辑个人签名:",t.value.userInfo.username)},N=()=>{console.log("添加标签")},$=()=>{console.log("查看关注列表:",t.value.userInfo.username)},S=()=>{console.log("查看粉丝列表:",t.value.userInfo.username)},W=()=>{console.log("查看获赞内容:",t.value.userInfo.username)},Z=V=>{console.log("切换到标签页:",V)},ee=V=>{console.log("查看作品:",V.title)},oe=()=>{console.log("创建新作品")},te=V=>{console.log("点赞评论:",V.id)},ae=V=>{console.log("回复评论:",V.id)},se=V=>{console.log("查看推荐:",V.title)};function M(V,A){const j=[`${A}的Vue3入门教程`,`${A}分享前端性能优化技巧`,`${A}的Element Plus教程`,`${A}讲解响应式布局`,`${A}的JavaScript高级特性`,`${A}的前端工程化实践`];return Array.from({length:V},(J,q)=>({id:`work-${q+1}`,title:j[q%j.length],cover:`https://via.placeholder.com/280x160?text=作品${q+1}`,duration:300+q*20,views:Math.floor(Math.random()*1e4),danmaku:Math.floor(Math.random()*1e3),publishDate:new Date(2023,5,10+q)}))}function T(V){const A=["内容很有帮助，学到了很多东西！","讲得很详细，期待更多优质内容","非常感谢分享，解决了我的问题","这个教程真的很棒，已经收藏了","讲解清晰，适合初学者学习"],j=["小明","小红","张三","李四","王五"];return Array.from({length:V},(J,q)=>({id:`comment-${q+1}`,userName:j[q%j.length],userAvatar:`https://via.placeholder.com/40x40?text=${q+1}`,content:A[q%A.length],commentTime:new Date(Date.now()-q*6e4*60),likes:Math.floor(Math.random()*100)}))}function G(V){const A=["Vue3最新特性深度解析","如何构建高性能前端应用","前端开发最佳实践指南","现代化UI设计原则","JavaScript异步编程详解","前端框架对比与选择"];return Array.from({length:V},(j,J)=>({id:`rec-${J+1}`,title:A[J%A.length],cover:`https://via.placeholder.com/300x170?text=推荐${J+1}`,views:Math.floor(Math.random()*2e4)}))}return b({open:g,close:k,watchVisible:E}),(V,A)=>{const j=d("el-button"),J=d("el-dialog");return c(),R(J,{modelValue:w.value,"onUpdate:modelValue":A[0]||(A[0]=q=>w.value=q),title:"预览个人主页",width:"80%",top:"2vh","before-close":s},{footer:o(()=>[e(j,{onClick:s},{default:o(()=>[...A[1]||(A[1]=[C("关闭",-1)])]),_:1})]),default:o(()=>[a("div",Uo,[e(Ee,{"background-image":t.value.backgroundImage,"is-following":t.value.isFollowing,"can-edit":!0,onFollow:m,onMessage:p,onShare:f,onReport:_},null,8,["background-image","is-following"]),e(We,{"user-info":t.value.userInfo,stats:t.value.stats,"user-tags":t.value.tags,"is-following":t.value.isFollowing,"can-edit":!0,"background-image":t.value.backgroundImage,onAvatarChange:B,onNameEdit:L,onBioEdit:H,onAddTag:N,onFollow:m,onMessage:p,onFollowingClick:$,onFollowersClick:S,onLikesClick:W,onBgChange:U},null,8,["user-info","stats","user-tags","is-following","background-image"]),e(To,{ref_key:"profileContentRef",ref:n,"content-stats":t.value.contentStats,"works-list":t.value.works,"comments-list":t.value.comments,"recommendations-list":t.value.recommendations,"can-edit":!0,onTabChange:Z,onWorkClick:ee,onCreateWork:oe,onCommentLike:te,onCommentReply:ae,onRecommendationClick:se},null,8,["content-stats","works-list","comments-list","recommendations-list"])])]),_:1},8,["modelValue"])}}},Do=z(Bo,[["__scopeId","data-v-4b6c8bf1"]]),Ao={class:"user-header"},Ro={__name:"UserHeader",props:{userInfo:{type:Object,required:!0}},setup(l){const b=l,u=F(null),i=F(!1),r=()=>{i.value=!0,u.value&&u.value.open()},n=()=>{i.value=!1},w=()=>{const v=`https://example.com/user/${b.userInfo.username}`;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(v).then(()=>{P.success("链接已复制到剪贴板")}).catch(()=>{I(v)}):I(v)},I=v=>{be.prompt("请复制以下链接:","分享个人主页",{confirmButtonText:"复制",cancelButtonText:"取消",inputValue:v,inputReadOnly:!0,callback:t=>{t==="confirm"&&P.success("请手动复制链接")}})};return(v,t)=>(c(),y("div",Ao,[e(Ie),e(Se,{onViewProfile:r,onShareProfile:w}),e(Do,{ref_key:"previewDialogRef",ref:u,"user-info":l.userInfo,visible:i.value,"onUpdate:visible":t[0]||(t[0]=h=>i.value=h),onClose:n},null,8,["user-info","visible"])]))}},Lo=z(Ro,[["__scopeId","data-v-ab0a153d"]]),Ho={class:"card-header"},qo={class:"header-actions"},Oo={class:"avatar-section"},zo={key:1,class:"upload-status"},No=["src"],jo={key:1,class:"background-display"},Wo=["src"],Jo={key:1},Go="/avatar-placeholder.png",Ko={__name:"BasicInfo",props:{userInfo:{type:Object,required:!0},editMode:{type:Boolean,default:!1},avatarUploading:{type:Boolean,default:!1},isFollowing:{type:Boolean,default:!1},backgroundImage:{type:String,default:""}},emits:["switch-edit","cancel-edit","save-info","upload-avatar","upload-success","upload-error","bg-change","follow","message"],setup(l,{emit:b}){const u=l,i=b,r=F(null),n=ne({...u.userInfo});X(()=>u.userInfo,k=>{Object.assign(n,k)},{deep:!0});const w={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符之间",trigger:"blur"}],nickname:[{max:50,message:"昵称长度不能超过 50 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入有效的手机号码",trigger:"blur"}],bio:[{max:200,message:"个人简介不能超过 200 个字符",trigger:"blur"}]},I=k=>k?k.charAt(0).toUpperCase():"U",v=k=>(i("upload-avatar",k),!1),t=(k,s)=>{i("upload-success",k,s)},h=k=>{i("upload-error",k)},E=async()=>{if(r.value)try{await r.value.validate(),i("save-info",{...n})}catch(k){console.error("表单验证失败:",k)}},g=()=>{Object.assign(n,u.userInfo),r.value&&r.value.resetFields(),i("cancel-edit")};return(k,s)=>{const m=d("el-button"),p=d("el-avatar"),f=d("el-upload"),_=d("el-input"),U=d("el-form-item"),B=d("el-radio"),L=d("el-radio-group"),H=d("el-icon"),N=d("el-form"),$=d("el-card");return c(),R($,{class:"user-info-card basic-info-card"},{header:o(()=>[a("div",Ho,[s[8]||(s[8]=a("span",null,"基本信息",-1)),a("div",qo,[e(m,{type:"primary",size:"small",onClick:s[0]||(s[0]=S=>k.$emit("switch-edit","basic")),disabled:l.editMode,class:"edit-btn"},{default:o(()=>[...s[7]||(s[7]=[C(" 编辑 ",-1)])]),_:1},8,["disabled"])])])]),default:o(()=>[e(N,{model:n,ref_key:"basicInfoFormRef",ref:r,rules:w,"label-width":"120px",class:"basic-info-form"},{default:o(()=>[a("div",Oo,[e(p,{size:"120",src:n.avatar||Go,class:"user-avatar"},{default:o(()=>[C(x(I(n.username)),1)]),_:1},8,["src"]),l.editMode?(c(),R(f,{key:0,class:"avatar-uploader",action:"#","show-file-list":!1,"before-upload":v,"on-success":t,"on-error":h},{default:o(()=>[e(m,{size:"small",type:"primary",class:"upload-button"},{default:o(()=>[...s[9]||(s[9]=[C("更换头像",-1)])]),_:1})]),_:1})):O("",!0),l.avatarUploading?(c(),y("p",zo,"上传中...")):O("",!0)]),e(U,{label:"用户名",prop:"username"},{default:o(()=>[e(_,{modelValue:n.username,"onUpdate:modelValue":s[1]||(s[1]=S=>n.username=S),disabled:!l.editMode,placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1}),e(U,{label:"昵称",prop:"nickname"},{default:o(()=>[e(_,{modelValue:n.nickname,"onUpdate:modelValue":s[2]||(s[2]=S=>n.nickname=S),disabled:!l.editMode,placeholder:"请输入昵称"},null,8,["modelValue","disabled"])]),_:1}),e(U,{label:"邮箱",prop:"email"},{default:o(()=>[e(_,{modelValue:n.email,"onUpdate:modelValue":s[3]||(s[3]=S=>n.email=S),disabled:!l.editMode,placeholder:"请输入邮箱",type:"email"},null,8,["modelValue","disabled"])]),_:1}),e(U,{label:"性别",prop:"gender"},{default:o(()=>[e(L,{modelValue:n.gender,"onUpdate:modelValue":s[4]||(s[4]=S=>n.gender=S),disabled:!l.editMode},{default:o(()=>[e(B,{label:1},{default:o(()=>[...s[10]||(s[10]=[C("男",-1)])]),_:1}),e(B,{label:2},{default:o(()=>[...s[11]||(s[11]=[C("女",-1)])]),_:1}),e(B,{label:0},{default:o(()=>[...s[12]||(s[12]=[C("保密",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(U,{label:"联系电话",prop:"phone"},{default:o(()=>[e(_,{modelValue:n.phone,"onUpdate:modelValue":s[5]||(s[5]=S=>n.phone=S),disabled:!l.editMode,placeholder:"请输入联系电话"},null,8,["modelValue","disabled"])]),_:1}),e(U,{label:"个人简介",prop:"bio"},{default:o(()=>[e(_,{modelValue:n.bio,"onUpdate:modelValue":s[6]||(s[6]=S=>n.bio=S),disabled:!l.editMode,type:"textarea",placeholder:"请输入个人简介",rows:3},null,8,["modelValue","disabled"])]),_:1}),e(U,{label:"主页背景",prop:"backgroundImage"},{default:o(()=>[l.editMode?(c(),R(f,{key:0,class:"background-uploader",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15","show-file-list":!1,"on-success":k.handleBgSuccess,"before-upload":k.beforeBgUpload,"list-type":"picture-card"},{default:o(()=>[n.backgroundImage?(c(),y("img",{key:0,src:n.backgroundImage,class:"background-preview"},null,8,No)):(c(),R(H,{key:1},{default:o(()=>[e(D(Y))]),_:1}))]),_:1},8,["on-success","before-upload"])):O("",!0),l.editMode?O("",!0):(c(),y("div",jo,[n.backgroundImage?(c(),y("img",{key:0,src:n.backgroundImage,class:"background-preview-static"},null,8,Wo)):(c(),y("span",Jo,"未设置背景图片"))]))]),_:1}),l.editMode?(c(),R(U,{key:0,class:"form-actions"},{default:o(()=>[e(m,{type:"primary",onClick:E},{default:o(()=>[...s[13]||(s[13]=[C("保存",-1)])]),_:1}),e(m,{onClick:g},{default:o(()=>[...s[14]||(s[14]=[C("取消",-1)])]),_:1})]),_:1})):O("",!0)]),_:1},8,["model"])]),_:1})}}},Qo=z(Ko,[["__scopeId","data-v-98dab5c5"]]),Yo={__name:"PasswordManager",props:{loading:{type:Boolean,default:!1}},emits:["change-password"],setup(l,{emit:b}){const u=b,i=F(null),r=ne({currentPassword:"",newPassword:"",confirmPassword:""}),n={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"新密码长度不能少于 6 个字符",trigger:"blur"},{validator:(v,t,h)=>{t===r.currentPassword?h(new Error("新密码不能与当前密码相同")):h()},trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(v,t,h)=>{t!==r.newPassword?h(new Error("两次输入的密码不一致")):h()},trigger:"blur"}]},w=async()=>{if(i.value)try{await i.value.validate(),u("change-password",{...r})}catch(v){console.error("密码表单验证失败:",v)}},I=()=>{r.currentPassword="",r.newPassword="",r.confirmPassword="",i.value&&i.value.resetFields()};return(v,t)=>{const h=d("el-input"),E=d("el-form-item"),g=d("el-button"),k=d("el-form"),s=d("el-card");return c(),R(s,{class:"user-info-card password-card"},{header:o(()=>[...t[3]||(t[3]=[a("div",{class:"card-header"},[a("span",null,"修改密码")],-1)])]),default:o(()=>[e(k,{model:r,ref_key:"passwordFormRef",ref:i,rules:n,"label-width":"120px"},{default:o(()=>[e(E,{label:"当前密码",prop:"currentPassword"},{default:o(()=>[e(h,{modelValue:r.currentPassword,"onUpdate:modelValue":t[0]||(t[0]=m=>r.currentPassword=m),type:"password",placeholder:"请输入当前密码"},null,8,["modelValue"])]),_:1}),e(E,{label:"新密码",prop:"newPassword"},{default:o(()=>[e(h,{modelValue:r.newPassword,"onUpdate:modelValue":t[1]||(t[1]=m=>r.newPassword=m),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(E,{label:"确认新密码",prop:"confirmPassword"},{default:o(()=>[e(h,{modelValue:r.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=m=>r.confirmPassword=m),type:"password",placeholder:"请确认新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(E,{class:"form-actions"},{default:o(()=>[e(g,{type:"primary",onClick:w,loading:l.loading},{default:o(()=>[...t[4]||(t[4]=[C("修改密码",-1)])]),_:1},8,["loading"]),e(g,{onClick:I},{default:o(()=>[...t[5]||(t[5]=[C("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})}}},Xo=z(Yo,[["__scopeId","data-v-addbdf10"]]),Zo={class:"security-info"},et={class:"security-item"},ot={class:"security-label"},tt={class:"security-actions"},at={class:"security-item"},st={class:"security-actions"},lt={key:0,class:"verified-status"},nt={key:1,class:"unverified-status"},it={class:"security-item"},rt={class:"security-label"},dt={class:"security-actions"},ct={__name:"SecuritySettings",props:{emailVerified:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},emits:["show-login-history","send-verification-email","toggle-two-factor"],setup(l,{emit:b}){const u=l,i=b,r=F(u.twoFactorEnabled);X(()=>u.twoFactorEnabled,v=>{r.value=v});const n=()=>{i("show-login-history")},w=()=>{i("send-verification-email")},I=()=>{i("toggle-two-factor")};return(v,t)=>{const h=d("el-icon"),E=d("el-tooltip"),g=d("el-button"),k=d("el-switch"),s=d("el-card");return c(),R(s,{class:"user-info-card security-card"},{header:o(()=>[...t[1]||(t[1]=[a("div",{class:"card-header"},[a("span",null,"账号安全")],-1)])]),default:o(()=>[a("div",Zo,[a("div",et,[a("div",ot,[t[2]||(t[2]=a("span",null,"登录记录",-1)),e(E,{content:"查看最近的登录活动",placement:"top"},{default:o(()=>[e(h,{class:"info-icon"},{default:o(()=>[e(D(re))]),_:1})]),_:1})]),a("div",tt,[e(g,{type:"text",onClick:n},{default:o(()=>[...t[3]||(t[3]=[C("查看历史记录",-1)])]),_:1})])]),a("div",at,[t[5]||(t[5]=a("div",{class:"security-label"},[a("span",null,"邮箱验证")],-1)),a("div",st,[l.emailVerified?(c(),y("span",lt,"已验证")):(c(),y("span",nt,"未验证")),e(g,{type:"text",onClick:w},{default:o(()=>[...t[4]||(t[4]=[C("重新发送验证",-1)])]),_:1})])]),a("div",it,[a("div",rt,[t[6]||(t[6]=a("span",null,"两步验证",-1)),e(E,{content:"提高账号安全性",placement:"top"},{default:o(()=>[e(h,{class:"info-icon"},{default:o(()=>[e(D(re))]),_:1})]),_:1})]),a("div",dt,[e(k,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=m=>r.value=m),onChange:I},null,8,["modelValue"])])])])]),_:1})}}},ut=z(ct,[["__scopeId","data-v-b65d5172"]]),mt={class:"login-history-content"},ft={key:0,class:"login-tip"},pt={__name:"LoginHistoryDialog",props:{modelValue:{type:Boolean,default:!1},loginHistory:{type:Array,default:()=>[]}},emits:["update:modelValue","close"],setup(l,{emit:b}){const u=l,i=b,r=le({get:()=>u.modelValue,set:w=>i("update:modelValue",w)}),n=()=>{r.value=!1,i("close")};return(w,I)=>{const v=d("el-table-column"),t=d("el-table"),h=d("el-alert"),E=d("el-button"),g=d("el-dialog");return c(),R(g,{modelValue:r.value,"onUpdate:modelValue":I[0]||(I[0]=k=>r.value=k),title:"登录历史记录",width:"800px","close-on-click-modal":!1},{footer:o(()=>[e(E,{onClick:n},{default:o(()=>[...I[1]||(I[1]=[C("关闭",-1)])]),_:1})]),default:o(()=>[a("div",mt,[e(t,{data:l.loginHistory,stripe:"","empty-text":"暂无登录历史记录"},{default:o(()=>[e(v,{prop:"time",label:"登录时间",width:"200"}),e(v,{prop:"ip",label:"登录IP",width:"150"}),e(v,{prop:"location",label:"登录地点",width:"150"}),e(v,{prop:"device",label:"设备信息"}),e(v,{prop:"browser",label:"浏览器",width:"150"})]),_:1},8,["data"]),l.loginHistory.length>0?(c(),y("div",ft,[e(h,{title:"安全提示",type:"warning",closable:!1,description:"发现可疑登录？请立即修改您的密码并开启两步验证。"})])):O("",!0)])]),_:1},8,["modelValue"])}}},vt=z(pt,[["__scopeId","data-v-0a9575ad"]]),gt={class:"two-factor-content"},_t={key:0},wt={key:0,class:"qrcode-container"},bt={key:1},ht={__name:"TwoFactorDialog",props:{modelValue:{type:Boolean,default:!1},enabled:{type:Boolean,default:!1}},emits:["update:modelValue","setup","disable"],setup(l,{emit:b}){const u=l,i=b,r=F(!1),n=F(""),w=F(""),I=le({get:()=>u.modelValue,set:k=>i("update:modelValue",k)}),v=le(()=>u.enabled?"关闭两步验证":"设置两步验证");X(()=>u.modelValue,k=>{k&&t()});const t=()=>{r.value=!1,n.value="",w.value=""},h=async()=>{if(!r.value){r.value=!0;return}if(!n.value){P.warning("请输入验证码");return}if(!/^\d{6}$/.test(n.value)){P.warning("请输入6位数字验证码");return}i("setup",n.value)},E=async()=>{if(!w.value){P.warning("请输入验证码");return}if(!/^\d{6}$/.test(w.value)){P.warning("请输入6位数字验证码");return}i("disable",w.value)},g=()=>{I.value=!1,t()};return(k,s)=>{const m=d("el-input"),p=d("el-button"),f=d("el-dialog");return c(),R(f,{modelValue:I.value,"onUpdate:modelValue":s[2]||(s[2]=_=>I.value=_),title:v.value,width:"500px","close-on-click-modal":!1},{footer:o(()=>[e(p,{onClick:g},{default:o(()=>[...s[8]||(s[8]=[C("取消",-1)])]),_:1})]),default:o(()=>[a("div",gt,[l.enabled?(c(),y("div",bt,[s[7]||(s[7]=a("p",{class:"two-factor-intro"},"两步验证已启用，您可以选择关闭它。",-1)),e(m,{modelValue:w.value,"onUpdate:modelValue":s[1]||(s[1]=_=>w.value=_),placeholder:"请输入验证码以关闭两步验证",class:"verification-input",maxlength:"6","show-word-limit":""},null,8,["modelValue"]),e(p,{type:"danger",onClick:E,disabled:!w.value,class:"action-button"},{default:o(()=>[...s[6]||(s[6]=[C(" 关闭两步验证 ",-1)])]),_:1},8,["disabled"])])):(c(),y("div",_t,[s[5]||(s[5]=a("p",{class:"two-factor-intro"},"两步验证可以提高您账号的安全性。启用后，每次登录时需要输入密码和验证码。",-1)),r.value?(c(),y("div",wt,[s[3]||(s[3]=a("div",{class:"qrcode-placeholder"},"二维码图片",-1)),s[4]||(s[4]=a("p",{class:"qrcode-text"},"请使用Google Authenticator或其他认证器应用扫描二维码",-1)),e(m,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=_=>n.value=_),placeholder:"请输入验证码",class:"verification-input",maxlength:"6","show-word-limit":""},null,8,["modelValue"])])):O("",!0),e(p,{type:"primary",onClick:h,disabled:r.value&&!n.value,class:"action-button"},{default:o(()=>[C(x(r.value?"确认设置":"开始设置"),1)]),_:1},8,["disabled"])]))])]),_:1},8,["modelValue","title"])}}},kt=z(ht,[["__scopeId","data-v-587ab063"]]),yt={class:"user-info-container"},Ct={class:"user-info-layout"},It={class:"left-column"},$t={class:"right-column"},Vt={__name:"index",setup(l){const b=he(),u=F(!1),i=F({}),r=F(!0),n=F(!1),w=F(!1),I=F(!1),v=F(!1),t=F(!1),h=F(!1),E=F(!1),g=ne({id:"",username:"",nickname:"",email:"",gender:1,phone:"",bio:"",avatar:"",backgroundImage:"",emailVerified:!1,followerCount:0,followingCount:0,viewsCount:0,likesReceived:0,activeTab:"dynamic",tabs:[{name:"dynamic",label:"动态"},{name:"works",label:"作品"},{name:"collections",label:"收藏"},{name:"history",label:"历史"}]}),k=F([{time:"2024-01-15 14:30:25",ip:"192.168.1.1",location:"中国 北京",device:"Windows 11",browser:"Chrome 119"},{time:"2024-01-14 09:15:42",ip:"192.168.1.1",location:"中国 北京",device:"MacOS",browser:"Safari 17"},{time:"2024-01-10 21:05:18",ip:"192.168.1.1",location:"中国 北京",device:"Android 13",browser:"Chrome Mobile"}]),s=M=>{M==="basic"&&(i.value={...g},u.value=!0)},m=()=>{Object.assign(g,i.value),u.value=!1},p=async M=>{try{await new Promise(T=>setTimeout(T,800)),Object.assign(g,M),b.userInfo={...b.userInfo,...M},P.success("基本信息更新成功"),u.value=!1}catch(T){throw console.error("保存基本信息失败:",T),P.error("保存基本信息失败，请重试"),T}},f=M=>(w.value=!0,!1),_=(M,T)=>{w.value=!1,P.success("头像上传成功")},U=()=>{w.value=!1,P.error("头像上传失败，请重试")},B=async M=>{try{I.value=!0,await new Promise(T=>setTimeout(T,1e3)),P.success("密码修改成功")}catch(T){throw console.error("修改密码失败:",T),P.error("修改密码失败，请重试"),T}finally{I.value=!1}},L=()=>{t.value=!0},H=async()=>{try{await new Promise(M=>setTimeout(M,500)),P.success("验证邮件已发送，请查收")}catch{P.error("发送验证邮件失败，请重试")}},N=()=>{h.value=!0},$=async M=>{await new Promise(T=>setTimeout(T,500)),E.value=!0,P.success("两步验证设置成功"),h.value=!1},S=async M=>{await new Promise(T=>setTimeout(T,500)),E.value=!1,P.success("两步验证已关闭"),h.value=!1},W=()=>{b.userInfo?Object.assign(g,{id:b.userInfo.id||"",username:b.userInfo.username||"",nickname:b.userInfo.nickname||"",email:b.userInfo.email||"",gender:b.userInfo.gender||1,phone:b.userInfo.phone||"",bio:b.userInfo.bio||"",avatar:b.userInfo.avatar||"",backgroundImage:b.userInfo.backgroundImage||"",emailVerified:b.userInfo.emailVerified||!1}):(g.id="1",g.username="admin",g.nickname="管理员",g.email="admin@example.com",g.gender=1,g.bio="这个人很懒，什么都没有留下",g.avatar="https://via.placeholder.com/200x280?text=%E5%B0%8F%E8%AF%B4%E5%B0%81%E9%9D%A2",g.backgroundImage="https://via.placeholder.com/1200x300?text=%E8%83%8C%E6%99%AF%E5%9B%BE",g.followerCount=128,g.followingCount=64,g.viewsCount=1024,g.likesReceived=512)},Z=()=>{r.value=!1,P.info("查看个人主页模式")},ee=()=>{r.value=!0,s("basic"),P.info("切换到编辑模式")},oe=()=>{const M=`https://example.com/user/${g.username}`;P.success(`分享链接: ${M}`)},te=async()=>{try{await new Promise(M=>setTimeout(M,500)),n.value=!n.value,n.value?(g.followerCount++,P.success("关注成功")):(g.followerCount--,P.success("已取消关注"))}catch(M){console.error("关注操作失败:",M),P.error("操作失败，请重试")}},ae=()=>{P.info("打开私信对话框")},se=M=>(v.value=!0,setTimeout(()=>{P.success("背景图更新成功"),v.value=!1},1e3),!1);return ke(()=>{W()}),(M,T)=>(c(),y("div",yt,[e(Lo,{"user-info":g,onViewProfile:Z,onEditProfile:ee,onShareProfile:oe},null,8,["user-info"]),a("div",Ct,[a("div",It,[e(Qo,{"user-info":g,"edit-mode":u.value,"avatar-uploading":w.value,"is-following":n.value,onSwitchEdit:s,onCancelEdit:m,onSaveInfo:p,onUploadAvatar:f,onUploadSuccess:_,onUploadError:U,onFollowUser:te,onSendMessage:ae,onChangeBackground:se},null,8,["user-info","edit-mode","avatar-uploading","is-following"])]),a("div",$t,[e(Xo,{loading:I.value,onChangePassword:B},null,8,["loading"]),e(ut,{"email-verified":g.emailVerified,"two-factor-enabled":E.value,onShowLoginHistory:L,onSendVerificationEmail:H,onToggleTwoFactor:N},null,8,["email-verified","two-factor-enabled"])])]),e(vt,{modelValue:t.value,"onUpdate:modelValue":T[0]||(T[0]=G=>t.value=G),"login-history":k.value},null,8,["modelValue","login-history"]),e(kt,{modelValue:h.value,"onUpdate:modelValue":T[1]||(T[1]=G=>h.value=G),enabled:E.value,onSetup:$,onDisable:S},null,8,["modelValue","enabled"])]))}},Pt=z(Vt,[["__scopeId","data-v-2cc11046"]]);export{Pt as default};
