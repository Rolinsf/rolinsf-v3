import{x as j,A as F,_ as q,e as S,S as i,N as r,q as D,c as g,a as u,b as m,g as A,w as o,r as c,R as f,o as d,F as P,k as y,d as I,t as N,E as x}from"./index-BDvhqHdq.js";const Y=()=>{const _=j();return{hasPermission:a=>_.hasPermission(a),hasAnyPermission:a=>_.hasAnyPermission(a),isRole:a=>_.userRole===a,isAdmin:()=>_.isAdmin,getPermissions:()=>_.userPermissions,formatPermissionName:a=>({"system:access":"系统管理访问","system:user:manage":"用户管理","system:log:view":"系统日志查看","system:settings:manage":"系统设置管理","system:role:manage":"角色权限管理","novel:access":"小说管理访问","novel:list:view":"小说列表查看","novel:comment:manage":"评论管理","novel:statistics:view":"数据统计查看"})[a]||a,permissions:F}},z={class:"role-permission-management"},H={class:"card-header"},J={class:"permission-group mb-4"},K={class:"permission-list"},Q={class:"permission-group"},X={class:"permission-list"},Z={__name:"index",setup(_){const{formatPermissionName:t}=Y(),n=S(""),E=S(["admin","editor","user"]),v=S([]),p=S([]),b=S(!1),a=[{value:i.ACCESS,label:t(i.ACCESS)},{value:i.USER_MANAGE,label:t(i.USER_MANAGE)},{value:i.LOG_VIEW,label:t(i.LOG_VIEW)},{value:i.SETTINGS_MANAGE,label:t(i.SETTINGS_MANAGE)}],M=[{value:r.ACCESS,label:t(r.ACCESS)},{value:r.LIST_VIEW,label:t(r.LIST_VIEW)},{value:r.COMMENT_MANAGE,label:t(r.COMMENT_MANAGE)},{value:r.STATISTICS_VIEW,label:t(r.STATISTICS_VIEW)}],V=l=>({admin:"管理员",editor:"编辑",user:"普通用户"})[l]||l,C=()=>{if(!n.value||!f[n.value]){v.value=[],p.value=[];return}const l=f[n.value];v.value=l.filter(e=>Object.values(i).includes(e)),p.value=l.filter(e=>Object.values(r).includes(e))},T=()=>{const l=[...v.value,...p.value];f[n.value]=l},O=async()=>{b.value=!0;try{await new Promise(l=>setTimeout(l,500)),x.success("权限保存成功"),console.log("权限已保存:",f)}catch(l){console.error("保存权限失败:",l),x.error("权限保存失败")}finally{b.value=!1}};return D(()=>{E.value.length>0&&(n.value=E.value[0],C())}),(l,e)=>{const L=c("el-option"),G=c("el-select"),R=c("el-col"),w=c("el-button"),U=c("el-row"),h=c("el-checkbox"),k=c("el-checkbox-group"),W=c("el-card"),B=c("el-empty");return d(),g("div",z,[e[6]||(e[6]=u("h1",null,"角色权限管理",-1)),m(U,{gutter:20,class:"mb-4"},{default:o(()=>[m(R,{span:6},{default:o(()=>[m(G,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),placeholder:"选择角色",onChange:C},{default:o(()=>[(d(!0),g(P,null,y(E.value,s=>(d(),A(L,{key:s,label:V(s),value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),m(R,{span:6},{default:o(()=>[m(w,{type:"primary",onClick:O,loading:b.value},{default:o(()=>[...e[3]||(e[3]=[I("保存权限",-1)])]),_:1},8,["loading"])]),_:1})]),_:1}),n.value?(d(),A(W,{key:0,class:"mb-4"},{header:o(()=>[u("div",H,[u("span",null,N(V(n.value))+" 的权限",1)])]),default:o(()=>[u("div",J,[e[4]||(e[4]=u("h3",{class:"permission-group-title"},"系统管理权限",-1)),m(k,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),onChange:T},{default:o(()=>[u("div",K,[(d(),g(P,null,y(a,s=>m(h,{key:s.value,label:s.value},{default:o(()=>[I(N(s.label),1)]),_:2},1032,["label"])),64))])]),_:1},8,["modelValue"])]),u("div",Q,[e[5]||(e[5]=u("h3",{class:"permission-group-title"},"小说管理权限",-1)),m(k,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),onChange:T},{default:o(()=>[u("div",X,[(d(),g(P,null,y(M,s=>m(h,{key:s.value,label:s.value},{default:o(()=>[I(N(s.label),1)]),_:2},1032,["label"])),64))])]),_:1},8,["modelValue"])])]),_:1})):(d(),A(B,{key:1,description:"请先选择一个角色"}))])}}},ee=q(Z,[["__scopeId","data-v-bff731b5"]]);export{ee as default};
